@model BugTrackerMvc.Models.Issue

@{
    ViewData["Title"] = "Details";
    var comments = ViewData["Comments"] as IEnumerable<Comment>;
}

<h1>@Model.Title - @(Model.Solved ? "Solved" : "Unsolved")</h1>

<div>
    <h5>@Model.Poster</h5>
    <hr />
    <h5>Issue:</h5>
    <p>@Model.Description</p>
    <hr />
    @if (User?.Identity?.IsAuthenticated ?? false)
    {
        <p>Add Comment</p>
        <form asp-action="Comment" asp-route-id="@Model.Id">
            <div class="form-group">
                <input type="text" hidden value=@Model.Poster name="Author" />
                <textarea name="Content" class="form-control"></textarea>
            </div>
            <div class="form-group">
                <input type="submit" value="Comment" class="btn btn-primary" />
            </div>
        </form>
    } 
    else
    {
        <div><a asp-controller="Authentication" asp-action="SignIn">Sign in</a> to comment</div>
    }

    @if (comments == null || comments.Count() == 0)
    {
        <div>
            <p>No comments yet...</p>
        </div>
    }
    else
    {
        @foreach (var comment in comments)
        {
            <div>
                <p>@comment.Content</p>
                <span>@comment.Author</span>
            </div>
        }
    }


</div>
<hr />
<div>
    <a asp-action="Edit" asp-route-id="@Model?.Id">Edit</a> |
    <a asp-action="Index">Back to List</a>
</div>
